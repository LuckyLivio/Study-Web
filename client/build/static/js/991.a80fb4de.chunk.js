"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[991],{89372:(e,t,l)=>{l.r(t),l.d(t,{default:()=>ve});var s=l(9950),n=l(35481),a=l(27532),i=l(5332),r=l(89379),c=l(43711),o=l(20900),d=l(27321),x=l(32284),h=l(91651),u=l(71500),A=l(87209),j=l(24556),g=l(56141),m=l(94837),p=l(66615),v=l(55547),f=l(52036),y=l(91521),b=l(46349),C=l(74184),w=l(57559),S=l(29742),k=l(80218),I=l(6732),z=l(65250),W=l(47371),B=l(12414),P=l(91724),E=l(64327),D=l(31872),T=l(39872),N=l(10431),F=l(71672),L=l(72619),R=l(65517),_=l(80045),H=l(82932);const G=["featuredImage"],M=(e,t)=>H.A.get("/blog".concat(e),t),O=(e,t,l)=>H.A.post("/blog".concat(e),t,l),q=(e,t,l)=>H.A.put("/blog".concat(e),t,l),K=(e,t)=>H.A.delete("/blog".concat(e),t),$={async getBlogs(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const l=await M("/",{params:t});return(null===(e=l.data)||void 0===e?void 0:e.data)||l.data||l},async getBlog(e){var t;const l=await M("/".concat(e));return(null===(t=l.data)||void 0===t?void 0:t.data)||l.data||l},async createBlog(e){if(e.featuredImage){var t;const l=new FormData;Object.entries(e).forEach(e=>{let[t,s]=e;"featuredImage"!==t&&void 0!==s&&l.append(t,s.toString())}),l.append("featuredImage",e.featuredImage);const s=await O("/",l,{headers:{"Content-Type":"multipart/form-data"}});return(null===(t=s.data)||void 0===t?void 0:t.data)||s.data||s}{var l;const{featuredImage:t}=e,s=(0,_.A)(e,G),n=await O("/",s,{headers:{"Content-Type":"application/json"}});return(null===(l=n.data)||void 0===l?void 0:l.data)||n.data||n}},async updateBlog(e,t){var l;const s=new FormData;Object.entries(t).forEach(e=>{let[t,l]=e;"featuredImage"!==t&&void 0!==l&&s.append(t,l.toString())}),t.featuredImage&&s.append("featuredImage",t.featuredImage);const n=await q("/".concat(e),s,{headers:{"Content-Type":"multipart/form-data"}});return(null===(l=n.data)||void 0===l?void 0:l.data)||n.data||n},async deleteBlog(e){await K("/".concat(e))},async likeBlog(e){var t;const l=await O("/".concat(e,"/like"));return(null===(t=l.data)||void 0===t?void 0:t.data)||l.data||l},async getCategories(){var e;const t=await M("/meta/categories");return(null===(e=t.data)||void 0===e?void 0:e.data)||t.data||t},async getTagCloud(){var e;const t=await M("/meta/tags");return(null===(e=t.data)||void 0===e?void 0:e.data)||t.data||t},async getBlogStats(){var e;const t=await M("/meta/stats");return(null===(e=t.data)||void 0===e?void 0:e.data)||t.data||t}};var U=l(41680),X=l(30817),Z=l(82024),J=l(81415),Q=l(45774),V=l(57315),Y=l(46514),ee=l(35987),te=l(52180),le=l(9627),se=l(80771),ne=l(44414);const ae=["children","value","index"],ie=["inline","className","children"];function re(e){const{children:t,value:l,index:s}=e,n=(0,_.A)(e,ae);return(0,ne.jsx)("div",(0,r.A)((0,r.A)({role:"tabpanel",hidden:l!==s,id:"simple-tabpanel-".concat(s),"aria-labelledby":"simple-tab-".concat(s)},n),{},{children:l===s&&(0,ne.jsx)(d.A,{sx:{p:0},children:t})}))}const ce=e=>{let{open:t,onClose:l,onSave:n,blog:a,categories:i,existingTags:c}=e;const[u,v]=(0,s.useState)({title:"",content:"",excerpt:"",tags:"",category:"\u65e5\u8bb0",status:"\u8349\u7a3f",isPublic:!0}),[f,b]=(0,s.useState)(0),[C,w]=(0,s.useState)(!1),[S,B]=(0,s.useState)(null),[P,E]=(0,s.useState)(""),[D,T]=(0,s.useState)([]),[N,L]=(0,s.useState)(""),[H,G]=(0,s.useState)(!1),[M,O]=(0,s.useState)(null),[q,K]=(0,s.useState)(null);(0,s.useEffect)(()=>{a?(v({title:a.title||"",content:a.content||"",excerpt:a.excerpt||"",tags:a.tags?a.tags.join(", "):"",category:a.category||"",status:a.status||"\u8349\u7a3f",isPublic:void 0===a.isPublic||a.isPublic}),T(a.tags||[])):(v({title:"",content:"",excerpt:"",tags:"",category:i.length>0?i[0]:"\u65e5\u8bb0",status:"\u5df2\u53d1\u5e03",isPublic:!0}),T([])),b(0),B(null),E(""),L(""),G(!1),O(null),K(null)},[a,t]);const ae=(e,t)=>{v(l=>(0,r.A)((0,r.A)({},l),{},{[e]:t}))},ce=()=>{if(P&&P.trim()&&!D.includes(P.trim())){const e=[...D,P.trim()];T(e),v(t=>(0,r.A)((0,r.A)({},t),{},{tags:e.join(", ")})),E("")}},oe=e=>{let{content:t}=e;return(0,ne.jsx)(ee.oz,{remarkPlugins:[te.A],components:{code(e){let{inline:t,className:l,children:s}=e;(0,_.A)(e,ie);const n=/language-(\w+)/.exec(l||"");return!t&&n?(0,ne.jsx)(le.A,{style:se.A,language:n[1],PreTag:"div",children:String(s).replace(/\n$/,"")}):(0,ne.jsx)("code",{className:l,children:s})}},children:t})};return(0,ne.jsxs)(k.A,{open:t,onClose:l,maxWidth:"lg",fullWidth:!0,children:[(0,ne.jsx)(I.A,{children:a?"\u7f16\u8f91\u535a\u5ba2":"\u65b0\u5efa\u535a\u5ba2"}),(0,ne.jsxs)(z.A,{children:[S&&(0,ne.jsx)(x.A,{severity:"error",sx:{mb:2},onClose:()=>B(null),children:S}),(0,ne.jsxs)(d.A,{sx:{display:"flex",flexDirection:"column",gap:2,mb:3},children:[(0,ne.jsx)(d.A,{children:(0,ne.jsx)(h.A,{fullWidth:!0,label:"\u6807\u9898",value:u.title,onChange:e=>ae("title",e.target.value),required:!0})}),(0,ne.jsxs)(d.A,{sx:{display:"flex",flexWrap:"wrap",gap:2},children:[(0,ne.jsxs)(d.A,{sx:{flex:"1 1 300px"},children:[(0,ne.jsxs)(A.A,{fullWidth:!0,children:[(0,ne.jsx)(j.A,{children:"\u5206\u7c7b"}),(0,ne.jsxs)(g.A,{value:H?"new":u.category,onChange:e=>{var t;"new"===(t=e.target.value)?G(!0):(v(e=>(0,r.A)((0,r.A)({},e),{},{category:t})),G(!1))},label:"\u5206\u7c7b",children:[i.map(e=>(0,ne.jsx)(m.A,{value:e,children:e},e)),(0,ne.jsx)(m.A,{value:"new",children:"+ \u65b0\u5efa\u5206\u7c7b"})]})]}),H&&(0,ne.jsxs)(d.A,{sx:{display:"flex",mt:1},children:[(0,ne.jsx)(h.A,{size:"small",label:"\u65b0\u5206\u7c7b\u540d\u79f0",value:N,onChange:e=>L(e.target.value),sx:{flexGrow:1,mr:1}}),(0,ne.jsx)(p.A,{onClick:()=>{N&&N.trim()&&(v(e=>(0,r.A)((0,r.A)({},e),{},{category:N.trim()})),G(!1),L(""))},variant:"outlined",children:"\u6dfb\u52a0"})]})]}),(0,ne.jsx)(d.A,{sx:{minWidth:150},children:(0,ne.jsxs)(A.A,{fullWidth:!0,children:[(0,ne.jsx)(j.A,{children:"\u72b6\u6001"}),(0,ne.jsxs)(g.A,{value:u.status,onChange:e=>ae("status",e.target.value),label:"\u72b6\u6001",children:[(0,ne.jsx)(m.A,{value:"\u8349\u7a3f",children:"\u8349\u7a3f"}),(0,ne.jsx)(m.A,{value:"\u5df2\u53d1\u5e03",children:"\u5df2\u53d1\u5e03"}),(0,ne.jsx)(m.A,{value:"\u79c1\u5bc6",children:"\u79c1\u5bc6"})]})]})}),(0,ne.jsx)(d.A,{sx:{minWidth:150},children:(0,ne.jsx)(U.A,{control:(0,ne.jsx)(X.A,{checked:u.isPublic,onChange:e=>ae("isPublic",e.target.checked)}),label:"\u516c\u5f00\u53ef\u89c1"})})]})]}),(0,ne.jsxs)(d.A,{sx:{mb:3},children:[(0,ne.jsx)(o.A,{variant:"subtitle2",gutterBottom:!0,children:"\u6807\u7b7e"}),(0,ne.jsx)(d.A,{sx:{display:"flex",flexWrap:"wrap",gap:1,mb:2},children:D.map(e=>(0,ne.jsx)(y.A,{label:e,onDelete:()=>(e=>{const t=D.filter(t=>t!==e);T(t),v(e=>(0,r.A)((0,r.A)({},e),{},{tags:t.join(", ")}))})(e),deleteIcon:(0,ne.jsx)(Q.A,{})},e))}),(0,ne.jsxs)(d.A,{sx:{display:"flex",gap:1},children:[(0,ne.jsx)(h.A,{size:"small",label:"\u6dfb\u52a0\u6807\u7b7e",value:P,onChange:e=>E(e.target.value),onKeyPress:e=>"Enter"===e.key&&ce(),sx:{flexGrow:1}}),(0,ne.jsx)(p.A,{onClick:ce,variant:"outlined",startIcon:(0,ne.jsx)(R.A,{}),children:"\u6dfb\u52a0"})]}),(0,ne.jsxs)(d.A,{sx:{mt:1},children:[(0,ne.jsx)(o.A,{variant:"caption",color:"text.secondary",children:"\u5e38\u7528\u6807\u7b7e\uff1a"}),c.slice(0,10).map(e=>(0,ne.jsx)(y.A,{label:e,size:"small",variant:"outlined",sx:{mr:.5,mt:.5},onClick:()=>{if(!D.includes(e)){const t=[...D,e];T(t),v(e=>(0,r.A)((0,r.A)({},e),{},{tags:t.join(", ")}))}}},e))]})]}),(0,ne.jsx)(h.A,{fullWidth:!0,label:"\u6458\u8981\uff08\u53ef\u9009\uff09",value:u.excerpt,onChange:e=>ae("excerpt",e.target.value),multiline:!0,rows:2,sx:{mb:3},helperText:"\u5982\u679c\u4e0d\u586b\u5199\uff0c\u5c06\u81ea\u52a8\u4ece\u5185\u5bb9\u4e2d\u63d0\u53d6"}),(0,ne.jsxs)(d.A,{sx:{mb:3},children:[(0,ne.jsx)(o.A,{variant:"subtitle2",gutterBottom:!0,children:"\u7279\u8272\u56fe\u7247\uff08\u53ef\u9009\uff09"}),(0,ne.jsx)("input",{accept:"image/*",style:{display:"none"},id:"featured-image-upload",type:"file",onChange:e=>{var t;const l=null===(t=e.target.files)||void 0===t?void 0:t[0];if(l){O(l);const e=new FileReader;e.onload=e=>{var t;K(null===(t=e.target)||void 0===t?void 0:t.result)},e.readAsDataURL(l)}}}),(0,ne.jsx)("label",{htmlFor:"featured-image-upload",children:(0,ne.jsx)(p.A,{variant:"outlined",component:"span",startIcon:(0,ne.jsx)(V.A,{}),children:"\u9009\u62e9\u56fe\u7247"})}),q&&(0,ne.jsx)(d.A,{sx:{mt:2},children:(0,ne.jsx)("img",{src:q,alt:"\u9884\u89c8",style:{maxWidth:"200px",maxHeight:"150px",objectFit:"cover"}})})]}),(0,ne.jsxs)(d.A,{sx:{border:1,borderColor:"divider",borderRadius:1},children:[(0,ne.jsxs)(Z.A,{value:f,onChange:(e,t)=>b(t),children:[(0,ne.jsx)(J.A,{icon:(0,ne.jsx)(F.A,{}),label:"\u7f16\u8f91"}),(0,ne.jsx)(J.A,{icon:(0,ne.jsx)(Y.A,{}),label:"\u9884\u89c8"})]}),(0,ne.jsx)(re,{value:f,index:0,children:(0,ne.jsx)(h.A,{fullWidth:!0,multiline:!0,rows:15,value:u.content,onChange:e=>ae("content",e.target.value),placeholder:"\u5728\u8fd9\u91cc\u5199\u4e0b\u4f60\u7684\u535a\u5ba2\u5185\u5bb9\uff0c\u652f\u6301 Markdown \u8bed\u6cd5...",variant:"outlined",sx:{"& .MuiOutlinedInput-root":{"& fieldset":{border:"none"}}}})}),(0,ne.jsx)(re,{value:f,index:1,children:(0,ne.jsx)(d.A,{sx:{p:2,minHeight:400,maxHeight:400,overflow:"auto"},children:u.content?(0,ne.jsx)(oe,{content:u.content}):(0,ne.jsx)(o.A,{color:"text.secondary",children:"\u5728\u7f16\u8f91\u6a21\u5f0f\u4e0b\u8f93\u5165\u5185\u5bb9\u540e\uff0c\u53ef\u4ee5\u5728\u8fd9\u91cc\u9884\u89c8\u6548\u679c"})})})]}),(0,ne.jsx)(d.A,{sx:{mt:2},children:(0,ne.jsx)(o.A,{variant:"caption",color:"text.secondary",children:"\u652f\u6301 Markdown \u8bed\u6cd5\uff1a**\u7c97\u4f53**\u3001*\u659c\u4f53*\u3001`\u4ee3\u7801`\u3001[\u94fe\u63a5](url)\u3001![\u56fe\u7247](url)\u3001 ```\u4ee3\u7801\u5757```\u3001\u8868\u683c\u3001\u4efb\u52a1\u5217\u8868\u7b49"})})]}),(0,ne.jsxs)(W.A,{children:[(0,ne.jsx)(p.A,{onClick:l,disabled:C,children:"\u53d6\u6d88"}),(0,ne.jsx)(p.A,{onClick:async()=>{if(u.title&&u.title.trim()&&u.content&&u.content.trim())try{w(!0),B(null);const e=(0,r.A)((0,r.A)({},u),{},{featuredImage:M||void 0});a?await $.updateBlog(a._id,e):await $.createBlog(e),n()}catch(l){var e,t;B((null===(e=l.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"\u4fdd\u5b58\u5931\u8d25"),console.error("Error saving blog:",l)}finally{w(!1)}else B("\u6807\u9898\u548c\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a")},variant:"contained",disabled:C||!u.title||!u.title.trim()||!u.content||!u.content.trim(),children:C?"\u4fdd\u5b58\u4e2d...":a?"\u66f4\u65b0":"\u521b\u5efa"})]})]})};var oe=l(5310),de=l(55884),xe=l(13285),he=l(51593),ue=l(20795),Ae=l(50169);const je=["inline","className","children"],ge=e=>{let{open:t,onClose:l,blog:n,onEdit:a,onDelete:i,onLike:r}=e;const[c,x]=(0,s.useState)(!1);if((0,s.useEffect)(()=>{x(!1)},[n]),!n)return null;const h=e=>{let{content:t}=e;return(0,ne.jsx)(ee.oz,{remarkPlugins:[te.A],components:{code(e){let{inline:t,className:l,children:s}=e;(0,_.A)(e,je);const n=/language-(\w+)/.exec(l||"");return!t&&n?(0,ne.jsx)(le.A,{style:se.A,language:n[1],PreTag:"div",children:String(s).replace(/\n$/,"")}):(0,ne.jsx)("code",{className:l,style:{backgroundColor:"#f5f5f5",padding:"2px 4px",borderRadius:"3px",fontSize:"0.9em"},children:s})},h1:e=>{let{children:t}=e;return(0,ne.jsx)(o.A,{variant:"h4",component:"h1",gutterBottom:!0,sx:{mt:3,mb:2},children:t})},h2:e=>{let{children:t}=e;return(0,ne.jsx)(o.A,{variant:"h5",component:"h2",gutterBottom:!0,sx:{mt:3,mb:2},children:t})},h3:e=>{let{children:t}=e;return(0,ne.jsx)(o.A,{variant:"h6",component:"h3",gutterBottom:!0,sx:{mt:2,mb:1},children:t})},p:e=>{let{children:t}=e;return(0,ne.jsx)(o.A,{variant:"body1",paragraph:!0,children:t})},blockquote:e=>{let{children:t}=e;return(0,ne.jsx)(d.A,{sx:{borderLeft:4,borderColor:"primary.main",pl:2,py:1,my:2,backgroundColor:"grey.50",fontStyle:"italic"},children:t})},table:e=>{let{children:t}=e;return(0,ne.jsx)(d.A,{sx:{overflowX:"auto",my:2},children:(0,ne.jsx)("table",{style:{width:"100%",borderCollapse:"collapse"},children:t})})},th:e=>{let{children:t}=e;return(0,ne.jsx)("th",{style:{border:"1px solid #ddd",padding:"8px 12px",backgroundColor:"#f5f5f5",textAlign:"left"},children:t})},td:e=>{let{children:t}=e;return(0,ne.jsx)("td",{style:{border:"1px solid #ddd",padding:"8px 12px"},children:t})}},children:t})};return(0,ne.jsxs)(k.A,{open:t,onClose:l,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{maxHeight:"90vh"}},children:[(0,ne.jsx)(I.A,{sx:{pb:1},children:(0,ne.jsxs)(d.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,ne.jsx)(o.A,{variant:"h5",component:"h1",sx:{flexGrow:1,pr:2},children:n.title}),(0,ne.jsx)(u.A,{onClick:l,size:"small",children:(0,ne.jsx)(Q.A,{})})]})}),(0,ne.jsxs)(z.A,{sx:{pt:1},children:[(0,ne.jsx)(v.A,{variant:"outlined",sx:{mb:3},children:(0,ne.jsxs)(f.A,{sx:{pb:"16px !important"},children:[(0,ne.jsxs)(d.A,{sx:{display:"flex",flexWrap:"wrap",gap:2,alignItems:"center"},children:[(0,ne.jsxs)(d.A,{sx:{display:"flex",alignItems:"center"},children:[(0,ne.jsx)(oe.A,{sx:{width:24,height:24,mr:1},children:(0,ne.jsx)(xe.A,{fontSize:"small"})}),(0,ne.jsx)(o.A,{variant:"body2",children:n.author})]}),(0,ne.jsxs)(d.A,{sx:{display:"flex",alignItems:"center"},children:[(0,ne.jsx)(D.A,{sx:{fontSize:16,mr:.5}}),(0,ne.jsx)(o.A,{variant:"body2",children:n.category})]}),(0,ne.jsx)(y.A,{label:n.status,size:"small",color:"\u5df2\u53d1\u5e03"===n.status?"success":"default"}),(0,ne.jsxs)(d.A,{sx:{display:"flex",alignItems:"center"},children:[(0,ne.jsx)(he.A,{sx:{fontSize:16,mr:.5}}),(0,ne.jsx)(o.A,{variant:"body2",children:new Date(n.createdAt).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"})})]}),(0,ne.jsxs)(d.A,{sx:{display:"flex",alignItems:"center"},children:[(0,ne.jsx)(ue.A,{sx:{fontSize:16,mr:.5}}),(0,ne.jsxs)(o.A,{variant:"body2",children:["\u7ea6 ",n.readingTime," \u5206\u949f"]})]})]}),(0,ne.jsxs)(d.A,{sx:{display:"flex",alignItems:"center",mt:2,gap:2},children:[(0,ne.jsxs)(d.A,{sx:{display:"flex",alignItems:"center"},children:[(0,ne.jsx)(T.A,{sx:{fontSize:16,mr:.5}}),(0,ne.jsxs)(o.A,{variant:"body2",children:[n.views," \u6b21\u6d4f\u89c8"]})]}),(0,ne.jsxs)(d.A,{sx:{display:"flex",alignItems:"center"},children:[(0,ne.jsx)(N.A,{sx:{fontSize:16,mr:.5}}),(0,ne.jsxs)(o.A,{variant:"body2",children:[n.likes," \u4e2a\u8d5e"]})]})]}),n.tags.length>0&&(0,ne.jsxs)(d.A,{sx:{mt:2},children:[(0,ne.jsxs)(d.A,{sx:{display:"flex",alignItems:"center",mb:1},children:[(0,ne.jsx)(E.A,{sx:{fontSize:16,mr:.5}}),(0,ne.jsx)(o.A,{variant:"body2",children:"\u6807\u7b7e\uff1a"})]}),(0,ne.jsx)(d.A,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:n.tags.map(e=>(0,ne.jsx)(y.A,{label:e,size:"small",variant:"outlined"},e))})]}),n.excerpt&&(0,ne.jsx)(d.A,{sx:{mt:2},children:(0,ne.jsx)(o.A,{variant:"body2",color:"text.secondary",sx:{fontStyle:"italic"},children:n.excerpt})})]})}),(0,ne.jsx)(de.A,{sx:{mb:3}}),(0,ne.jsx)(d.A,{sx:{"& > *:first-of-type":{mt:0}},children:(0,ne.jsx)(h,{content:n.content})})]}),(0,ne.jsx)(W.A,{sx:{px:3,pb:2},children:(0,ne.jsxs)(d.A,{sx:{display:"flex",justifyContent:"space-between",width:"100%"},children:[(0,ne.jsx)(d.A,{children:(0,ne.jsx)(w.A,{title:c?"\u53d6\u6d88\u70b9\u8d5e":"\u70b9\u8d5e",children:(0,ne.jsx)(u.A,{onClick:()=>{r(n),x(!c)},color:c?"primary":"default",size:"large",children:c?(0,ne.jsx)(N.A,{}):(0,ne.jsx)(Ae.A,{})})})}),(0,ne.jsxs)(d.A,{sx:{display:"flex",gap:1},children:[(0,ne.jsx)(p.A,{onClick:()=>a(n),startIcon:(0,ne.jsx)(F.A,{}),variant:"outlined",children:"\u7f16\u8f91"}),(0,ne.jsx)(p.A,{onClick:()=>i(n),startIcon:(0,ne.jsx)(L.A,{}),color:"error",variant:"outlined",children:"\u5220\u9664"}),(0,ne.jsx)(p.A,{onClick:l,variant:"contained",children:"\u5173\u95ed"})]})]})})]})},me=()=>{const[e,t]=(0,s.useState)([]),[l,n]=(0,s.useState)(!0),[a,i]=(0,s.useState)(null),[_,H]=(0,s.useState)(""),[G,M]=(0,s.useState)(""),[O,q]=(0,s.useState)(""),[K,U]=(0,s.useState)("createdAt"),[X,Z]=(0,s.useState)("desc"),[J,Q]=(0,s.useState)(1),[V,Y]=(0,s.useState)(1),[ee,te]=(0,s.useState)([]),[le,se]=(0,s.useState)([]),[ae,ie]=(0,s.useState)(!1),[re,oe]=(0,s.useState)(!1),[de,xe]=(0,s.useState)(null),[he,ue]=(0,s.useState)(!1),[Ae,je]=(0,s.useState)(null),me=async()=>{try{n(!0);const e={page:J,limit:9,search:_||void 0,category:G||void 0,tags:O||void 0,sortBy:K,sortOrder:X},l=await $.getBlogs(e);t(l.blogs),Y(Math.ceil(l.pagination.total/9))}catch(e){i("\u52a0\u8f7d\u535a\u5ba2\u5931\u8d25"),console.error("Error loading blogs:",e)}finally{n(!1)}},pe=async()=>{try{const[e,t]=await Promise.all([$.getCategories(),$.getTagCloud()]);te(e),se(t)}catch(e){console.error("Error loading metadata:",e)}};(0,s.useEffect)(()=>{me()},[J,_,G,O,K,X]),(0,s.useEffect)(()=>{pe()},[]);const ve=()=>{Q(1),me()},fe=async l=>{try{const s=await $.likeBlog(l._id);t(e.map(e=>e._id===l._id?(0,r.A)((0,r.A)({},e),{},{likes:s.likes}):e))}catch(s){console.error("Error liking blog:",s)}},ye=e=>{xe(e),ie(!0)},be=e=>{je(e),ue(!0)};return l&&0===e.length?(0,ne.jsx)(c.A,{maxWidth:"lg",sx:{py:4},children:(0,ne.jsx)(o.A,{children:"\u52a0\u8f7d\u4e2d..."})}):(0,ne.jsxs)(c.A,{maxWidth:"lg",sx:{py:4},children:[(0,ne.jsxs)(d.A,{sx:{display:"flex",alignItems:"center",mb:3},children:[(0,ne.jsx)(B.A,{style:{width:32,height:32,marginRight:12,color:"#1976d2"}}),(0,ne.jsx)(o.A,{variant:"h4",component:"h1",sx:{fontWeight:"bold",fontSize:"1.5rem"},children:"\u535a\u5ba2\u65e5\u8bb0"})]}),a&&(0,ne.jsx)(x.A,{severity:"error",sx:{mb:2},onClose:()=>i(null),children:a}),(0,ne.jsx)(d.A,{sx:{mb:3},children:(0,ne.jsxs)(d.A,{sx:{display:"flex",flexWrap:"wrap",gap:2,alignItems:"center",mb:2},children:[(0,ne.jsx)(d.A,{sx:{minWidth:200,flex:"1 1 auto"},children:(0,ne.jsx)(h.A,{fullWidth:!0,label:"\u641c\u7d22\u535a\u5ba2",value:_,onChange:e=>H(e.target.value),onKeyPress:e=>"Enter"===e.key&&ve(),InputProps:{endAdornment:(0,ne.jsx)(u.A,{onClick:ve,children:(0,ne.jsx)(P.A,{})})}})}),(0,ne.jsx)(d.A,{sx:{minWidth:150},children:(0,ne.jsxs)(A.A,{fullWidth:!0,children:[(0,ne.jsx)(j.A,{children:"\u5206\u7c7b"}),(0,ne.jsxs)(g.A,{value:G,onChange:e=>M(e.target.value),label:"\u5206\u7c7b",children:[(0,ne.jsx)(m.A,{value:"",children:"\u5168\u90e8\u5206\u7c7b"}),ee.map(e=>(0,ne.jsx)(m.A,{value:e,children:e},e))]})]})}),(0,ne.jsx)(d.A,{sx:{minWidth:150},children:(0,ne.jsxs)(A.A,{fullWidth:!0,children:[(0,ne.jsx)(j.A,{children:"\u6807\u7b7e"}),(0,ne.jsxs)(g.A,{value:O,onChange:e=>q(e.target.value),label:"\u6807\u7b7e",children:[(0,ne.jsx)(m.A,{value:"",children:"\u5168\u90e8\u6807\u7b7e"}),le.map(e=>(0,ne.jsxs)(m.A,{value:e.tag,children:[e.tag," (",e.count,")"]},e.tag))]})]})}),(0,ne.jsx)(d.A,{sx:{minWidth:150},children:(0,ne.jsxs)(A.A,{fullWidth:!0,children:[(0,ne.jsx)(j.A,{children:"\u6392\u5e8f"}),(0,ne.jsxs)(g.A,{value:"".concat(K,"-").concat(X),onChange:e=>{const[t,l]=e.target.value.split("-");U(t),Z(l)},label:"\u6392\u5e8f",children:[(0,ne.jsx)(m.A,{value:"createdAt-desc",children:"\u6700\u65b0\u53d1\u5e03"}),(0,ne.jsx)(m.A,{value:"createdAt-asc",children:"\u6700\u65e9\u53d1\u5e03"}),(0,ne.jsx)(m.A,{value:"views-desc",children:"\u6d4f\u89c8\u6700\u591a"}),(0,ne.jsx)(m.A,{value:"likes-desc",children:"\u70b9\u8d5e\u6700\u591a"}),(0,ne.jsx)(m.A,{value:"title-asc",children:"\u6807\u9898A-Z"})]})]})}),(0,ne.jsx)(d.A,{children:(0,ne.jsx)(p.A,{onClick:()=>{H(""),M(""),q(""),U("createdAt"),Z("desc"),Q(1)},variant:"outlined",children:"\u91cd\u7f6e"})})]})}),(0,ne.jsx)(d.A,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"repeat(2, 1fr)",lg:"repeat(3, 1fr)"},gap:3},children:e.map(e=>(0,ne.jsxs)(v.A,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[(0,ne.jsxs)(f.A,{sx:{flexGrow:1},children:[(0,ne.jsx)(o.A,{variant:"h6",component:"h2",gutterBottom:!0,children:e.title}),(0,ne.jsx)(o.A,{variant:"body2",color:"text.secondary",sx:{mb:2},children:e.excerpt||e.content.substring(0,100)+"..."}),(0,ne.jsxs)(d.A,{sx:{mb:2},children:[e.tags.slice(0,3).map(e=>(0,ne.jsx)(y.A,{label:e,size:"small",sx:{mr:.5,mb:.5},icon:(0,ne.jsx)(E.A,{})},e)),e.tags.length>3&&(0,ne.jsx)(y.A,{label:"+".concat(e.tags.length-3),size:"small",variant:"outlined"})]}),(0,ne.jsxs)(d.A,{sx:{display:"flex",alignItems:"center",mb:1},children:[(0,ne.jsx)(D.A,{sx:{mr:.5,fontSize:16}}),(0,ne.jsx)(o.A,{variant:"caption",sx:{mr:2},children:e.category}),(0,ne.jsx)(y.A,{label:e.status,size:"small",color:"\u5df2\u53d1\u5e03"===e.status?"success":"default"})]}),(0,ne.jsxs)(d.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,ne.jsx)(o.A,{variant:"caption",color:"text.secondary",children:new Date(e.createdAt).toLocaleDateString()}),(0,ne.jsxs)(d.A,{sx:{display:"flex",alignItems:"center"},children:[(0,ne.jsx)(T.A,{sx:{fontSize:16,mr:.5}}),(0,ne.jsx)(o.A,{variant:"caption",sx:{mr:1},children:e.views}),(0,ne.jsx)(N.A,{sx:{fontSize:16,mr:.5}}),(0,ne.jsx)(o.A,{variant:"caption",children:e.likes})]})]})]}),(0,ne.jsxs)(b.A,{children:[(0,ne.jsx)(p.A,{size:"small",onClick:()=>(e=>{xe(e),oe(!0)})(e),startIcon:(0,ne.jsx)(T.A,{}),children:"\u67e5\u770b"}),(0,ne.jsx)(p.A,{size:"small",onClick:()=>ye(e),startIcon:(0,ne.jsx)(F.A,{}),children:"\u7f16\u8f91"}),(0,ne.jsx)(p.A,{size:"small",color:"error",onClick:()=>be(e),startIcon:(0,ne.jsx)(L.A,{}),children:"\u5220\u9664"}),(0,ne.jsx)(u.A,{size:"small",onClick:()=>fe(e),color:e.likes>0?"primary":"default",children:(0,ne.jsx)(N.A,{})})]})]},e._id))}),V>1&&(0,ne.jsx)(d.A,{sx:{display:"flex",justifyContent:"center",mt:4},children:(0,ne.jsx)(C.A,{count:V,page:J,onChange:(e,t)=>Q(t),color:"primary"})}),(0,ne.jsx)(w.A,{title:"\u5199\u65b0\u535a\u5ba2",children:(0,ne.jsx)(S.A,{color:"primary","aria-label":"add",sx:{position:"fixed",bottom:16,right:16},onClick:()=>ie(!0),children:(0,ne.jsx)(R.A,{})})}),(0,ne.jsx)(ce,{open:ae,onClose:()=>{ie(!1),xe(null)},onSave:()=>{ie(!1),xe(null),me(),pe()},blog:de,categories:ee,existingTags:le.map(e=>e.tag)}),(0,ne.jsx)(ge,{open:re,onClose:()=>{oe(!1),xe(null)},blog:de,onEdit:ye,onDelete:be,onLike:fe}),(0,ne.jsxs)(k.A,{open:he,onClose:()=>ue(!1),children:[(0,ne.jsx)(I.A,{children:"\u786e\u8ba4\u5220\u9664"}),(0,ne.jsx)(z.A,{children:(0,ne.jsxs)(o.A,{children:['\u786e\u5b9a\u8981\u5220\u9664\u535a\u5ba2 "',null===Ae||void 0===Ae?void 0:Ae.title,'" \u5417\uff1f\u6b64\u64cd\u4f5c\u65e0\u6cd5\u64a4\u9500\u3002']})}),(0,ne.jsxs)(W.A,{children:[(0,ne.jsx)(p.A,{onClick:()=>ue(!1),children:"\u53d6\u6d88"}),(0,ne.jsx)(p.A,{onClick:async()=>{if(Ae)try{await $.deleteBlog(Ae._id),ue(!1),je(null),me()}catch(e){i("\u5220\u9664\u535a\u5ba2\u5931\u8d25"),console.error("Error deleting blog:",e)}},color:"error",variant:"contained",children:"\u5220\u9664"})]})]})]})},pe=(0,n.A)({palette:{primary:{main:"#1976d2"},secondary:{main:"#dc004e"}},typography:{fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif'}}),ve=()=>(0,ne.jsxs)(a.A,{theme:pe,children:[(0,ne.jsx)(i.Ay,{}),(0,ne.jsx)(me,{})]})}}]);